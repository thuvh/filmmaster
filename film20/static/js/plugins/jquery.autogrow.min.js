(function($){$.fn.autogrow=function(){this.filter('textarea').each(function(){var $this=$(this),minHeight=$this.height();var shadow=$('<div></div>').css({position:'absolute',top:-10000,left:-10000,width:$(this).width(),fontSize:$this.css('font-size'),fontFamily:$this.css('font-family'),lineHeight:$this.css('line-height'),resize:'none'}).appendTo(document.body);var update=function(){var val=this.value.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/&/g,'&amp;').replace(/\n/g,'<br/>');shadow.html(val);$(this).css('height',Math.max(shadow.height()+20,minHeight))};$(this).change(update).keyup(update).keydown(update);update.apply(this)});return this}})(jQuery);